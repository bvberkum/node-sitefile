
# To skip builds use [ci ckip] in GIT commit-msg

language: node_js

node_js:
  # Note: selenium-webdriver does not support node <4. Would need to degrade tests.
  #- "0.12"
  # Note: >=4 seems to be working like 6.0
  #- "4.4"
  #- "5.11"
  - "6.1"

addons:
  apt:
    packages:
      - python-docutils
      - graphviz
  firefox: "45.0"

before_install:
  - npm install -g bower

before_script:
  # Note Se not working in mocha - test "$TRAVIS_NODE_VERSION" != "0.12" || { npm uninstall selenium-webdriver; npm install selenium-webdriver@2.53.3; }
  - "export DISPLAY=:99.0"
  - "sh -e /etc/init.d/xvfb start"
  - sleep 3 # give xvfb some time to start
  - "wget http://selenium-release.storage.googleapis.com/2.53/selenium-server-standalone-2.53.0.jar"
  - "java -jar selenium-server-standalone-2.53.0.jar > /dev/null &"
  - sleep 3
  - test -x "$(which rst2html)" || { mkdir ~/bin && cd ~/bin && ln -s $(which rst2html.py) rst2html; }
  - rst2html --version

script:
  - npm run test-tap

after_script:
  - . ./tools/publish-tap.sh

env:
  - NODE_ENV=testing PATH=/usr/local/bin:$HOME/bin:$PATH ENV=testing

#branches:
#  only:
#   - master
#   - /^test.*$/
#   - /^feature.*$/
#   - /^r[0-9].*$/

notifications:
  email:
    on_success: never
