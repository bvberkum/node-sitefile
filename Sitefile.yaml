#!/usr/bin/env sitefile
#
# Sitefile for node-sitefile document server
# A note of caution: this example config does shameless things like executing any shell
# script if you want to, like call http://localhost/clean.sh. Ymmv. 
#
# Id: node-sitefile/0.0.5-dev+20161010
sitefile: 0.0.5-dev
routes:

  # FIXME: prefix mapping
  media: static:public/media

  scripts/default.js: static:scripts/default.js
  
  example: redir:example/main
  example/bookshelf/knex.sqlite/_/v1: bookshelfapi:example/bookshelf/knex.json
  example/bookshelf/knex: knex:example/bookshelf/knex.json
  _example: 'static:example'

  _pug: pug:example/**/*.pug
  _stylus: stylus:example/**/*.styl
  _coffee: coffee:example/**/*.coffee
  _markdown: markdown:*.md
  _markdown_1: markdown:example/**/*.md
  _sh: sh:example/*.sh
  _gv: gv:example/*.gv

  'src/*': 'prism:'

  components: static:public/components
  'components/jsonary/test': redir:components/jsonary/test/index
  'components/jsonary/test/index': static:public/components/jsonary/test/index.html

  # Some defaults for root
  #FIXME: 
  '': redir:ReadMe
  index: redir:ReadMe

  # Example routes for ReadMe
  #ReadMe: du:ReadMe.rst # Du defaults to HTML
  #ReadMe: redir:ReadMe.html
  #ReadMe.html: du:ReadMe.rst
  #ReadMe.xml: du:ReadMe.rst
  
  # Dynamic rules using glob spec
  _du: du:**/*.rst
  #_rst2html: rst2html:**/*.rst
  
  Sitefile: redir:Sitefile.yaml
  Sitefile.yaml: static:Sitefile.yaml
  Sitefile.json: sitefile:?resolve=sitefile
  Sitefile/debug: sitefile:#
  Sitefile/resource: sitefile.resource:#
  Sitefile/handler: sitefile.handler:#
  Sitefile/global: sitefile.global:#

  Sitefile/core: 'core:'

  _json-editor: json-editor:example/json-editor/schema/*.json

  jsonary: redir:example/jsonary
  jsonary_test: jsonary:test
  #jsonary: redir:components/jsonary/index.html

  api: jsonary-rest-api:example/jsonary-rest-api/bookmarks
  api/$action: jsonary-rest-api:example/jsonary-rest-api/bookmarks

  api/elegant/: jsonary-rest-api:example/jsonary-rest-api/elegant

  example/polymer-app-router: static:example/polymer-app-router.html

  #example: static:example

  #components/core-toolbar: static:public/components/polymer-ui-toolbar
  #components/core-menu: static:public/components/polymer-ui-menu
  #components/core-item: static:public/components/polymer-ui-item
  #components/core-header-panel: static:public/components/polymer-ui-header-panel
  #components/core-toolbar: static:public/components/polymer-ui-toolbar


options:
  du:
    stylesheets:
      $ref: '#/defs/stylesheets/default/paths'
  rst2html:
    flags:
    - "--no-toc-backlinks"
    scripts:
      - /components/jquery/dist/jquery.min.js
      - /scripts/default.js
    stylesheets:
      $ref: '#/defs/stylesheets/default/paths'
  pug:
    stylesheets:
      $ref: '#/defs/stylesheets/default/urls'

defs:
  stylesheets:
    default:
      urls:
        - /media/style/default.css
      paths:
        - public/media/style/default.css


apps:
  base:
    scripts: []
    stylesheets:
      - href: /media/style/default.css
        path: public/media/style/default.css

