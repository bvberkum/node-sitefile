doctype html

head
  head
    title PM2 process list
    link(rel="stylesheet", type="text/css", href="/components/bootstrap/dist/css/bootstrap.css")
    script(type="text/javascript", src="/components/jquery/dist/jquery.min.js")
    script(type="text/javascript", src="/components/bootstrap/dist/js/bootstrap.js")
    script(type="text/javascript", src= script)

  body

    .container.pm2-list(data-urlbase=base)

      h3 List of PM2 processes

      - states = {stopped: '', errored: 'danger', online: 'success'}

      table.table.table-condensed.table-striped.table-hover
        tr
          th(colspan=2) PM

          th Status
          th CWD
          th CMD
          th ENV
          th PID

          th(colspan=3) Uptime

          th(colspan=2)

        tr.small
          th Id
          th Name

          th(colspan=5)

          th (sec)
          th (min)
          th (hr)

          th.small Restart
          th.small Stop

        each app in apps
          - st = app.pm2_env.status
          - muted = st == 'stopped' ? ' text-muted' : ''
          tr(class=app.name+muted)
            th
              a(href=context.base+context.name+"/"+app.pm_id+".json")= app.pm_id
            th
              a(href=context.base+context.name+"/"+app.pm_id+".html")= app.name
            td(class=states[st])= app.pm2_env.status
            td= app.pm2_env.cwd
            td= app.pm2_env.pm_exec_path
            td= app.pm2_env.ENV
            td= app.pid
            td= ( ( Date.now() - app.pm2_env.pm_uptime ) / 1000).toLocaleString( 'en-us', {maximumSignificantDigits: 3})
            td= ( ( Date.now() - app.pm2_env.pm_uptime ) / 60 / 1000 ).toLocaleString( 'en-us', {maximumSignificantDigits: 3})
            td= ( ( Date.now() - app.pm2_env.pm_uptime ) / 3600 / 1000 ).toLocaleString( 'en-us', {maximumSignificantDigits: 3})
            td
              button(type="button",data-appid=app.pm_id).restart.btn.btn-default.btn-sm
                span.glyphicon.glyphicon-refresh(aria-hidden="true")
            td
              button(type="button",data-appid=app.pm_id).stop.btn.btn-default.btn-sm
                span.glyphicon.glyphicon-stop(aria-hidden="true")



